C51 COMPILER V9.59.0.0   MAIN                                                              12/23/2018 13:48:58 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\output\main.obj
COMPILER INVOKED BY: E:\MDK\C51\BIN\C51.EXE c\main.c OPTIMIZE(8,SPEED) BROWSE NOINTPROMOTE INCDIR(.\h) DEBUG OBJECTEXTEN
                    -D PRINT(.\list\main.lst) OBJECT(.\output\main.obj)

line level    source

   1          #include "system.h"
   2          
   3          /*************************************************************
   4          ËµÃ÷£º
   5          1¡¢Options for Target¡®Target1¡¯£ºBL51 Locate->Code Range:0x100£¬ÉÕÂ¼Ñ¡ÏîÇëÑ¡ÔñDISRST£¬¸´Î»½Å×÷ÎªÆÕÍ¨IOÊ¹Ó
             -Ã£»
   6          2¡¢¸Ä±äTESTµÄ¶¨Òå£¬¿ÉÒÔ·Ö±ð²âÊÔ¶ÔÓ¦µÄ¹¦ÄÜ£»
   7          ***************************************************************/
   8          
   9          #define  Receive_IO_Data             P12
  10          
  11          extern unsigned char LED_SWITCH_OPEN_FLAG,LED_SWITCH_CLOSE_FLAG;
  12          extern unsigned int  u8cnt2s_open,u8cnt2s_close;
  13          unsigned char LED_FLAG;
  14          TIMEOUT_PARA Shake_Time[2];
  15          
  16          extern unsigned char Cnt200ms;
  17          unsigned int Cnt800ms;
  18          
  19          extern unsigned int AdcValue;
  20          
  21          unsigned char u8cnt50ms,u8CntMs;//50ms¼ÆÊ±
  22          
  23          unsigned char Start_Receive_Data ;//¿ªÊ¼½ÓÊÕÊý¾Ý
  24          unsigned char Value,STAT,R_Data;
  25          unsigned char High_Leve_Time,Low_Leve_Time;//¸ßµçÆ½Ê±¼ä
  26          unsigned char Total_Data=8;    //×ÜÊý¾Ý³¤¶È
  27          unsigned int u16Cnt4hours;
  28          unsigned char  u8shuttime;
  29          unsigned char  u8Data_time;//½ÓÊÕÊý¾ÝµÄÊ±¼ä£¬Èç¹û0.5SÖ®ÄÚÃ»ÓÐÊÕµ½Êý¾Ý£¬½«·¢ÈÈÆ¬¹Ø±Õ
  30          unsigned char Flag;
  31          unsigned char Data;                                                                        
  32          
  33          /*************************************************************
  34          ËµÃ÷£º
  35          TEST==TEST_TIMER
  36          1¡¢¶¨Ê±Æ÷ÎªÏòÉÏÒç³ö·½Ê½£¬T¶¨Ê±¼ÆËã¹«Ê½=TxÊ±ÖÓÔ´*£¨ÂúÁ¿³ÌÖµ+1-Ô¤×°ÔØÖµ£©
  37          ***************************************************************/
  38          
  39          void timer1()interrupt 3                                //Timer1ÏòÁ¿ºÅ 3
  40          {
  41   1              TH1 = (65536 - 3000)/256;                   //ÔÙ´Î×°Èë³õÖµ
  42   1              TL1 = (65536 - 3000)%256;                       //0.25ms½øÀ´Ò»´Î
  43   1      
  44   1              if(Cnt800ms++ > 800)                //200ms½øÀ´Ò»´Î
  45   1              {
  46   2                 Cnt800ms = 0;
  47   2                 Cnt200ms++;
  48   2              }
  49   1      
  50   1              R_Data=Receive_IO_Data;
  51   1          if((R_Data==0)&&(Start_Receive_Data==0))  //Òýµ¼ÂëµÍµçÆ½µÄÊ±¼ä
  52   1          {
  53   2                 ++u8cnt50ms;
C51 COMPILER V9.59.0.0   MAIN                                                              12/23/2018 13:48:58 PAGE 2   

  54   2          }
  55   1              if(R_Data==1)          //µçÆ½Îª¸ßÊ±ÅÐ¶ÏµÍµçÆ½µÄÊ±¼ä
  56   1              {
  57   2                      if((15<=u8cnt50ms)&&(22>=u8cnt50ms))    //Ê±¼ä·¶Î§ÔÚÒýµ¼µÍµçÆ½µÄ·¶Î§ÄÚ£¬¿ªÊ¼½ÓÊÕ
  58   2                      {
  59   3                              Low_Leve_Time=0;
  60   3                              u8cnt50ms=0;
  61   3                              High_Leve_Time=0;
  62   3                              Value=0;
  63   3                              Total_Data=8;
  64   3                      Start_Receive_Data=1;
  65   3                   }
  66   2                   else if(22<=u8cnt50ms)     //´óÓÚ ·ñÔò²»½ÓÊÕ
  67   2                   {
  68   3                              Low_Leve_Time=0;
  69   3                              u8cnt50ms=0;
  70   3                              High_Leve_Time=0;
  71   3                              Value=0;
  72   3                              Total_Data=8;
  73   3                      Start_Receive_Data=0;
  74   3                   }
  75   2                   else                       //·ñÔòÇå³ý¼ÆÊý
  76   2                   {
  77   3                      u8cnt50ms=0;
  78   3                   }      
  79   2              }
  80   1      
  81   1              if(Start_Receive_Data)   //¿ªÊ¼½ÓÊÕÊý¾Ý
  82   1              {
  83   2                  if(Total_Data>0)    //½ÓÊÕ°Ë´Î
  84   2                  { 
  85   3                                if(R_Data==1)       //¸ßµçÆ½µÄÊ±¼ä
  86   3                                {
  87   4                                        Flag=1;            //µÍµçÆ½Ê±ÅÐ¶Ï±êÖ¾
  88   4                                High_Leve_Time++;   //¸ßµçÆ½Ê±¼ä¼ÆÊý
  89   4                                }
  90   3                            if((R_Data==0)&&(Flag==1))  //µÍµçÆ½Ê±ÅÐ¶Ï¸ßµçÆ½Ê±¼ä£¬flag±êÖ¾Î»Ö»½øÈëÒ»´Î£¬                                                                                                                                      //Ö»Ó
             -ÐÔÚÏÂ´Î·­×ªµÄÊ±ºò²ÅÄÜ½øÈëÅÐ¶Ï
  91   3                                { 
  92   4                                        Value=Value<<1;             //Êý¾ÝÊ×ÏÈ×óÒÆ£¬°ËÎ»Êý¾ÝÖ»ÐèÒÆÎ»Æß´Î
  93   4                                        Flag=0;                    //Çå±êÖ¾
  94   4                                    Low_Leve_Time++;            //µÍµçÆ½Ê±¼ä¼ÆÊý
  95   4                                    if((High_Leve_Time>=7)&&(High_Leve_Time<=10))  //ÅÐ¶ÏÂëÎª1
  96   4                                {
  97   5                                                       Low_Leve_Time=0;
  98   5                                                       High_Leve_Time=0;
  99   5                                                       Value |= 0x01;
 100   5                                                       Total_Data--;
 101   5                            }
 102   4                                else if((High_Leve_Time>=1)&&(High_Leve_Time<=6))  //ÅÐ¶ÏÂëÎª0
 103   4                            {
 104   5                                                       Low_Leve_Time=0;
 105   5                                                       High_Leve_Time=0;
 106   5                                                       Value &= (~0x01);
 107   5                                                       Total_Data--;
 108   5                                        }
 109   4                            } 
 110   3                                if((High_Leve_Time>16)||(Low_Leve_Time>8))      //ÈÝ´í´¦Àí£¬ÔÚ½ÓÊÕÍêÊý¾Ýºó»á½øÈë
 111   3                            {
 112   4                                        Low_Leve_Time=0;
 113   4                                        High_Leve_Time=0;
 114   4                                        u8cnt50ms=0;
C51 COMPILER V9.59.0.0   MAIN                                                              12/23/2018 13:48:58 PAGE 3   

 115   4                                Start_Receive_Data=0;
 116   4                                        Value=0;
 117   4                                        Total_Data=8;
 118   4                                }
 119   3                        }
 120   2           else   //½ÓÊÕÍê³É£¬Çå³ýÏà¹ØÊý¾Ý
 121   2           {
 122   3                        Low_Leve_Time=0;
 123   3                        High_Leve_Time=0;
 124   3                        u8cnt50ms=0;
 125   3                        Start_Receive_Data=0;
 126   3                        Data=Value;
 127   3                        Total_Data=8;
 128   3                u8Data_time=0;
 129   3                        //P00 = ~P00;
 130   3      
 131   3               }
 132   2          }
 133   1      }       
 134          /*************************************************************
 135          ËµÃ÷£ºmain()
 136          
 137          ***************************************************************/
 138          void main()
 139          {
 140   1          P12IH;
 141   1              System_Init();
 142   1              while(1)
 143   1              {
 144   2                      WDTCON |= 0x10;             //Çå¿´ÃÅ¹·
 145   2                      System_Handle();                
 146   2              }
 147   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    360    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     34    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
